var ztools={apply:function(b,c,a){if((typeof b)=="function"){return b.apply(b,c?c:[])}return a}};var rootUrl;var title;var width;var height;var treeType;var showContent;var noDeparmentUser;var onlineVisible;var chkStyle;var treeNodeData;var chkboxType;var departmentShow;var leafEnable;var multiLeafJson;var feedbackEnable;var showInput;var showThing;var hiddenInput;var hiddenThing;var append;var callback;var myztreeObj={pCheckNodeList:"",pCheckUserNodeList:"",pCheckDeparmentNodeList:"",pCheckWorkgroupNodeList:"",pCurrentCheckedNode:"",pCurrentClickNode:"",pCurrentClickParentNode:"",checkAll:""};var API=[{myObj:{pCheckNodeList:myztreeObj.pCheckNodeList,pCurrentCheckedNode:myztreeObj.pCurrentCheckedNode},multi:{getCheckNodeList:function(){return myztreeObj.pCheckNodeList},getCheckNodeListByType:function(a){if(a=="user"){return myztreeObj.pCheckUserNodeList}else{if(a=="department"){return myztreeObj.pCheckDeparmentNodeList}else{if(a=="workgroup"){return myztreeObj.pCheckWorkgroupNodeList}}}},getCheckUserNodeByParam:function(e){var a="";var g=myztreeObj.pCheckUserNodeList;if(myztreeObj.checkAll=="CHECKALL"){return"CHECKALL"}else{for(var c=0;c<g.length;c++){var d=JSON.parse(g[c].data);if(e=="id"){var f=g[c].id.split("_")[1];a+=f+","}else{if(e=="name"){a+=g[c].name+","}else{if(e=="pId"){var b=g[c].pId.split("_")[1];a+=b+","}else{if(e=="loginName"){a+=d.loginName+","}else{if(e=="email"){a+=d.email+","}}}}}}return a.substring(0,a.length-1)}},getCheckDepartmentNodeByParam:function(f){var a="";var d=myztreeObj.pCheckDeparmentNodeList;if(myztreeObj.checkAll=="CHECKALL"){return"CHECKALL"}else{for(var c=0;c<d.length;c++){var e=JSON.parse(d[c].data);if(f=="id"){var g=d[c].id.split("_")[1];a+=g+","}else{if(f=="name"){a+=d[c].name+","}else{if(f=="pId"){var b=d[c].pId.split("_")[1];a+=b+","}else{if(f=="code"){a+=e.code+","}else{if(f=="shortTitle"){a+=e.shortTitle+","}else{if(f=="summary"){a+=e.summary+","}}}}}}}return a.substring(0,a.length-1)}},getCheckWorkgroupNodeByParam:function(f){var b="";var a=myztreeObj.pCheckWorkgroupNodeList;if(myztreeObj.checkAll=="CHECKALL"){return"CHECKALL"}else{for(var d=0;d<a.length;d++){var e=JSON.parse(a[d].data);if(f=="id"){var g=a[d].id.split("_")[1];b+=g+","}else{if(f=="name"){b+=a[d].name+","}else{if(f=="pId"){var c=a[d].pId.split("_")[1];b+=c+","}else{if(f=="code"){b+=e.code+","}else{if(f=="description"){b+=e.description+","}}}}}}return b.substring(0,b.length-1)}},getCurrentCheckNode:function(){return myztreeObj.pCurrentCheckedNode}},single:{getCurrentClickNode:function(){return myztreeObj.pCurrentClickNode},getCurrentClickParentNode:function(){return myztreeObj.pCurrentClickParentNode},getCurrentClickNodeId:function(){return myztreeObj.pCurrentClickNode.id.split("_")[1]},getCurrentClickNodeParentId:function(){return myztreeObj.pCurrentClickNode.pId.split("_")[1]},getCurrentClickNodeName:function(){return myztreeObj.pCurrentClickNode.name},getCurrentClickNodeType:function(){return myztreeObj.pCurrentClickNode.type},getCurrentClickNodeData:function(){return myztreeObj.pCurrentClickNode.data},getClickUserValueByParam:function(c){var a="";var d=myztreeObj.pCurrentClickNode;if(d.type=="user"){var b=JSON.parse(d.data);if(c=="id"){a=d.id.split("_")[1]}else{if(c=="name"){a=d.name}else{if(c=="pId"){a=d.pId.split("_")[1]}else{if(c=="loginName"){a=b.loginName}else{if(c=="email"){a=b.email}}}}}}return a},getClickDepartmentValueByParam:function(c){var a="";var d=myztreeObj.pCurrentClickNode;if(d.type=="department"){var b=JSON.parse(d.data);if(c=="id"){a=d.id.split("_")[1]}else{if(c=="name"){a=d.name}else{if(c=="pId"){a=d.pId.split("_")[1]}else{if(c=="code"){a=b.code}else{if(c=="shortTitle"){a=b.shortTitle}else{if(c=="summary"){a=b.summary}}}}}}}return a},getClickWorkgroupValueByParam:function(c){var a="";var d=myztreeObj.pCurrentClickNode;if(d.type=="workgroup"){var b=JSON.parse(d.data);if(c=="id"){a=d.id.split("_")[1]}else{if(c=="name"){a=d.name}else{if(c=="pId"){a=d.pId.split("_")[1]}else{if(c=="code"){a=b.code}else{if(c=="description"){a=b.description}}}}}}return a}}}];function popZtree(a){rootUrl=a.view.url;title=a.view.title;width=a.view.width;height=a.view.height;treeType=a.type.treeType;showContent=ztools.apply(a.type.showContent,"",a.type.showContent);noDeparmentUser=a.type.noDeparmentUser;onlineVisible=a.type.onlineVisible;chkStyle=a.data.chkStyle;treeNodeData=ztools.apply(a.data.treeNodeData,"",a.data.treeNodeData);chkboxType=a.data.chkboxType;departmentShow=ztools.apply(a.data.departmentShow,"",a.data.departmentShow);leafEnable=a.leaf.enable;multiLeafJson=ztools.apply(a.leaf.multiLeafJson,"",a.leaf.multiLeafJson);feedbackEnable=a.feedback.enable;showInput=a.feedback.showInput;showThing=ztools.apply(a.feedback.showThing,"",a.feedback.showThing);hiddenInput=a.feedback.hiddenInput;hiddenThing=ztools.apply(a.feedback.hiddenThing,"",a.feedback.hiddenThing);append=a.feedback.append;callback=a.callback.onClose;var b=rootUrl+"portal/ztree-pop.action?treeType="+treeType+"&chkStyle="+chkStyle+"&treeNodeData="+treeNodeData+"&chkboxType="+chkboxType+"&treeNodeShowContent="+showContent+"&userWithoutDeptVisible="+noDeparmentUser+"&onlineVisible="+onlineVisible+"&leafEnable="+leafEnable+"&multiLeafJson="+multiLeafJson+"&feedbackEnable="+feedbackEnable+"&showInput="+showInput+"&showThing="+showThing+"&hiddenInput="+hiddenInput+"&hiddenThing="+hiddenThing+"&append="+append+"&departmentShow="+departmentShow;$.colorbox({href:encodeURI(b),iframe:true,innerWidth:width,innerHeight:height,overlayClose:false,title:title,onClosed:function(){ztools.apply(callback,API,callback)}});return API}var myZtree={clearInput:function(){if(typeof(showInput)=="undefined"||showInput==""){return}$("#"+showInput).attr("value","");if(typeof(hiddenInput)=="undefined"||hiddenInput==""){return}$("#"+hiddenInput).attr("value","")},deleteInput:function(f){if(typeof(showInput)=="undefined"||showInput==""){return}var e=getCachFromCookieByKey("showCachContent"+showInput);if(typeof(hiddenInput)=="undefined"||hiddenInput==""){return}var d=getCachFromCookieByKey("hiddenCachContent"+hiddenInput);if(e==""){alert("\u663e\u793a\u7f13\u5b58\u4e3a\u7a7a!");return}if(d==""){alert("\u9690\u85cf\u7f13\u5b58\u4e3a\u7a7a!");return}if(!isAvailable(e,d)){alert("\u663e\u793a\u7684\u683c\u5f0f\u548c\u9690\u85cf\u57df\u683c\u5f0f\u8bbe\u7f6e\u4e0d\u4e00\u81f4!");return}var c=createJson(e,d);var b=$("#removeStaffJson").val();if(typeof(b)=="undefined"){$("#"+f).append("<input type='hidden' id='removeStaffJson' name='removeStaffJson' value='"+c+"'/> ")}else{$("#removeStaffJson").attr("value",c)}var a=rootUrl+"portal/remove-ztree.action?showInput="+showInput+"&hiddenInput="+hiddenInput;$.colorbox({href:encodeURI(a),iframe:true,innerWidth:400,innerHeight:400,overlayClose:false,title:"\u79fb\u9664",onClosed:function(){}})}};function getCachFromCookieByKey(e){var a="";var f=unescape(document.cookie).split(";");for(var d=0;d<f.length-1;d++){var c=f[d].split("=")[0];var b=f[d].split("=")[1];if($.trim(c)==$.trim(e)){a=b}}return a}function createJson(e,l){var f=e.split("+");var b=l.split("+");var k="[";for(var d=0;d<f.length;d++){var h=$.trim(f[d].split(":")[0]);var g=f[d].split(":")[1].split(",");var a=b[d].split(":")[1].split(",");if(h=="user"){for(var c=0;c<g.length;c++){k=k+'{"type":"user","showValue":"'+g[c]+'","hiddenValue":"'+a[c]+'"},'}}else{if(h=="department"){for(var c=0;c<g.length;c++){k=k+'{"type":"department","showValue":"'+g[c]+'","hiddenValue":"'+a[c]+'"},'}}else{if(h=="workgroup"){for(var c=0;c<g.length;c++){k=k+'{"type":"workgroup","showValue":"'+g[c]+'","hiddenValue":"'+a[c]+'"},'}}}}}k=k.substring(0,k.length-1)+"]";return k}function isAvailable(d,c){var a=true;var e=d.split("+");var b=c.split("+");if(e.length!=b.length){a=false}if(d.indexOf("user:")!=-1&&c.indexOf("user:")==-1){a=false}if(c.indexOf("user:")!=-1&&d.indexOf("user:")==-1){a=false}if(d.indexOf("department:")!=-1&&c.indexOf("department:")==-1){a=false}if(c.indexOf("department:")!=-1&&d.indexOf("department:")==-1){a=false}if(d.indexOf("workgroup:")!=-1&&c.indexOf("workgroup:")==-1){a=false}if(c.indexOf("workgroup:")!=-1&&d.indexOf("workgroup:")==-1){a=false}return a};
